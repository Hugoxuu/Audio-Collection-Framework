{"modules":[{"id":"05786880-5093-47af-83fe-571d0874c640","type":"SetLoggingBehavior","branches":[{"condition":"Success","transition":"a1ee365f-64eb-4dc4-9b75-6d978b3aa7bb"}],"parameters":[{"name":"LoggingBehavior","value":"Enable"}],"metadata":{"position":{"x":152,"y":21}}},{"id":"a1ee365f-64eb-4dc4-9b75-6d978b3aa7bb","type":"SetRecordingBehavior","branches":[{"condition":"Success","transition":"b7366ea7-5910-4b2c-bda1-1f98eff0ae3a"}],"parameters":[{"name":"RecordingBehaviorOption","value":"Enable"},{"name":"RecordingParticipantOption","value":"Both"}],"metadata":{"position":{"x":151,"y":257}}},{"id":"b14af4cc-f855-45c8-bfba-2ac34addbce4","type":"PlayPrompt","branches":[{"condition":"Success","transition":"b7366ea7-5910-4b2c-bda1-1f98eff0ae3a"}],"parameters":[{"name":"Text","value":"The PIN code you entered is not valid.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":659,"y":22},"useDynamic":false}},{"id":"67498b06-fb3f-48ae-8543-1a016ed576b2","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"True","transition":"f246ea01-62be-4771-a0de-03889182127e"},{"condition":"NoMatch","transition":"b14af4cc-f855-45c8-bfba-2ac34addbce4"}],"parameters":[{"name":"Attribute","value":"response"},{"name":"Namespace","value":"External"}],"metadata":{"position":{"x":905,"y":226},"conditionMetadata":[{"id":"3c805e15-c978-44f0-aca2-badc7c3c367a","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"True"}]}},{"id":"6043995b-c8de-4834-8595-64861010436d","type":"StopMediaStreaming","branches":[{"condition":"Success","transition":"31d81d5a-3e1f-4980-8cbe-bc0b19995348"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[{"name":"ParticipantTypes","value":"Customer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":2660,"y":400}}},{"id":"b7366ea7-5910-4b2c-bda1-1f98eff0ae3a","type":"StoreUserInput","branches":[{"condition":"Success","transition":"27af4434-b34b-46f6-a228-2480661fb62e"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"Text","value":"Please enter 6-digit user PIN code.","namespace":null},{"name":"TextToSpeechType","value":"text"},{"name":"CustomerInputType","value":"Custom"},{"name":"Timeout","value":"6"},{"name":"MaxDigits","value":20},{"name":"EncryptEntry","value":false}],"metadata":{"position":{"x":416,"y":225},"useDynamic":false,"useDynamicForEncryptionKeys":true,"countryCodePrefix":"+1"}},{"id":"27af4434-b34b-46f6-a228-2480661fb62e","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"67498b06-fb3f-48ae-8543-1a016ed576b2"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:624988735887:function:checkPINcode","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"userPIN","value":"Stored customer input","namespace":"System"}],"metadata":{"position":{"x":656,"y":224},"dynamicMetadata":{"userPIN":true},"useDynamic":false},"target":"Lambda"},{"id":"f2cdbff4-92e9-4ab1-af72-512fdc368c75","type":"StoreUserInput","branches":[{"condition":"Success","transition":"c8719015-b593-448e-84dc-bfe0ca7e23f1"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"Text","value":"Please enter 5-digit conversation PIN code.","namespace":null},{"name":"TextToSpeechType","value":"text"},{"name":"CustomerInputType","value":"Custom"},{"name":"Timeout","value":"6"},{"name":"MaxDigits","value":20},{"name":"EncryptEntry","value":false}],"metadata":{"position":{"x":1409,"y":224},"useDynamic":false,"useDynamicForEncryptionKeys":true,"countryCodePrefix":"+1"}},{"id":"f246ea01-62be-4771-a0de-03889182127e","type":"SetAttributes","branches":[{"condition":"Success","transition":"f2cdbff4-92e9-4ab1-af72-512fdc368c75"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"Attribute","value":"Stored customer input","key":"customerPin","namespace":"System"}],"metadata":{"position":{"x":1150,"y":226}}},{"id":"31d81d5a-3e1f-4980-8cbe-bc0b19995348","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"284b09cf-5cb9-4ee7-bfe1-bd6181cf4e78"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:624988735887:function:TriggerLambdaFunction","namespace":null},{"name":"TimeLimit","value":"3"}],"metadata":{"position":{"x":2903,"y":393},"dynamicMetadata":{},"useDynamic":false},"target":"Lambda"},{"id":"284b09cf-5cb9-4ee7-bfe1-bd6181cf4e78","type":"PlayPrompt","branches":[{"condition":"Success","transition":"c92b9970-bdfe-4687-8d06-35c172d4eee5"}],"parameters":[{"name":"Text","value":"The talk is ended. Goodbye!","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":3529,"y":464},"useDynamic":false}},{"id":"c92b9970-bdfe-4687-8d06-35c172d4eee5","type":"Disconnect","branches":[],"parameters":[],"metadata":{"position":{"x":3787,"y":467}}},{"id":"355aa310-d46f-4675-8c65-989f21217ec7","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"6043995b-c8de-4834-8595-64861010436d"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:624988735887:function:storeLexConversation","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"contactId","value":"ContactId","namespace":"System"},{"name":"Parameter","key":"result","value":"success","namespace":null}],"metadata":{"position":{"x":2889,"y":713},"dynamicMetadata":{"contactId":true,"result":false},"useDynamic":false},"target":"Lambda"},{"id":"4a0e3a72-0eb8-4437-9cc3-3a3b2a4efeaa","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"6043995b-c8de-4834-8595-64861010436d"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:624988735887:function:storeLexConversation","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"contactId","value":"ContactId","namespace":"System"},{"name":"Parameter","key":"result","value":"failure","namespace":null}],"metadata":{"position":{"x":2886,"y":913},"dynamicMetadata":{"contactId":true,"result":false},"useDynamic":false},"target":"Lambda"},{"id":"63af844d-8b25-42e6-a3c5-18d3dee8e231","type":"GetUserInput","branches":[{"condition":"NoMatch","transition":"355aa310-d46f-4675-8c65-989f21217ec7"},{"condition":"Error","transition":"4a0e3a72-0eb8-4437-9cc3-3a3b2a4efeaa"}],"parameters":[{"name":"AudioPrompt","value":"arn:aws:connect:us-east-1:624988735887:instance/ec66c7d9-6ade-4a64-a185-5c3565d6b845/prompt/d4a1af37-5149-475a-8288-a24c90e46266","namespace":null,"resourceName":"Beep.wav"},{"name":"BotName","value":"OrderFlowers"},{"name":"BotAlias","value":"$LATEST"},{"name":"BotRegion","value":"us-east-1"},{"name":"Parameter","key":"contactId","value":"ContactId","namespace":"System"}],"metadata":{"position":{"x":2446,"y":701},"promptName":"Beep.wav","conditionMetadata":[],"useDynamic":false,"dynamicMetadata":{"contactId":true}},"target":"Lex"},{"id":"17cb0a30-457d-46b9-9a65-fc3fbb8dbfd0","type":"GetUserInput","branches":[{"condition":"NoMatch","transition":"355aa310-d46f-4675-8c65-989f21217ec7"},{"condition":"Error","transition":"4a0e3a72-0eb8-4437-9cc3-3a3b2a4efeaa"}],"parameters":[{"name":"AudioPrompt","value":"arn:aws:connect:us-east-1:624988735887:instance/ec66c7d9-6ade-4a64-a185-5c3565d6b845/prompt/d4a1af37-5149-475a-8288-a24c90e46266","namespace":null,"resourceName":"Beep.wav"},{"name":"BotName","value":"BookTrip"},{"name":"BotAlias","value":"$LATEST"},{"name":"BotRegion","value":"us-east-1"},{"name":"Parameter","key":"contactId","value":"ContactId","namespace":"System"}],"metadata":{"position":{"x":2452,"y":940},"promptName":"Beep.wav","conditionMetadata":[],"useDynamic":false,"dynamicMetadata":{"contactId":true}},"target":"Lex"},{"id":"be7b66c9-7fab-458a-977c-b995a961d846","type":"PlayPrompt","branches":[{"condition":"Success","transition":"284b09cf-5cb9-4ee7-bfe1-bd6181cf4e78"}],"parameters":[{"name":"Text","value":"Something wrong.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":3227,"y":1119},"useDynamic":false}},{"id":"5d56dc56-5a41-4fba-9674-898b56740e07","type":"StartMediaStreaming","branches":[{"condition":"Success","transition":"f06abb63-a628-4e6e-9633-d8addd1d8c78"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[{"name":"ParticipantTypes","value":"Customer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":2399,"y":400}}},{"id":"f06abb63-a628-4e6e-9633-d8addd1d8c78","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"OrderFlowers","transition":"63af844d-8b25-42e6-a3c5-18d3dee8e231"},{"condition":"Evaluate","conditionType":"Equals","conditionValue":"BookTrip","transition":"17cb0a30-457d-46b9-9a65-fc3fbb8dbfd0"},{"condition":"NoMatch","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"Attribute","value":"bot"},{"name":"Namespace","value":"External"}],"metadata":{"position":{"x":2160,"y":659},"conditionMetadata":[{"id":"8856b117-9cbd-4160-b01d-b0d99066838a","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"OrderFlowers"},{"id":"5f9719d1-de99-4569-a334-69c49f13f170","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"BookTrip"}]}},{"id":"66191827-be30-4b8c-ad35-6411ee22666c","type":"PlayPrompt","branches":[{"condition":"Success","transition":"223af26f-2742-459f-a09b-65e08d4587d7"}],"parameters":[{"name":"Text","value":"You are going to talk to a human agent.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":2160,"y":23},"useDynamic":false}},{"id":"4e325da5-727d-42b1-a69e-1205c0ed6b77","type":"PlayPrompt","branches":[{"condition":"Success","transition":"5d56dc56-5a41-4fba-9674-898b56740e07"}],"parameters":[{"name":"Text","value":"You are going to talk to a Lex Bot.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":2162,"y":399},"useDynamic":false}},{"id":"717162c9-343e-4f23-91cd-5e8d8bf9fdeb","type":"PlayPrompt","branches":[{"condition":"Success","transition":"f2cdbff4-92e9-4ab1-af72-512fdc368c75"}],"parameters":[{"name":"Text","value":"The PIN code you entered is not valid.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":1681,"y":19},"useDynamic":false}},{"id":"c8719015-b593-448e-84dc-bfe0ca7e23f1","type":"InvokeExternalResource","branches":[{"condition":"Success","transition":"211eca0c-0c57-4d95-b722-c36b06de9293"},{"condition":"Error","transition":"be7b66c9-7fab-458a-977c-b995a961d846"}],"parameters":[{"name":"FunctionArn","value":"arn:aws:lambda:us-east-1:624988735887:function:checkPINcode","namespace":null},{"name":"TimeLimit","value":"3"},{"name":"Parameter","key":"conversationPIN","value":"Stored customer input","namespace":"System"}],"metadata":{"position":{"x":1679,"y":221},"dynamicMetadata":{"conversationPIN":true},"useDynamic":false},"target":"Lambda"},{"id":"211eca0c-0c57-4d95-b722-c36b06de9293","type":"CheckAttribute","branches":[{"condition":"Evaluate","conditionType":"Equals","conditionValue":"human","transition":"66191827-be30-4b8c-ad35-6411ee22666c"},{"condition":"Evaluate","conditionType":"Equals","conditionValue":"bot","transition":"4e325da5-727d-42b1-a69e-1205c0ed6b77"},{"condition":"NoMatch","transition":"717162c9-343e-4f23-91cd-5e8d8bf9fdeb"}],"parameters":[{"name":"Attribute","value":"response"},{"name":"Namespace","value":"External"}],"metadata":{"position":{"x":1936,"y":221},"conditionMetadata":[{"id":"de4c0ee2-8835-45c5-a67e-f681c357dd02","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"human"},{"id":"f2ccdca4-a0ec-49a2-904d-062c3f5a4947","operator":{"name":"Equals","value":"Equals","shortDisplay":"="},"value":"bot"}]}},{"id":"57f9d28f-f005-4feb-b880-79025fe75e15","type":"Transfer","branches":[{"condition":"AtCapacity","transition":"be7b66c9-7fab-458a-977c-b995a961d846"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[],"metadata":{"position":{"x":2911,"y":19},"useDynamic":false,"queue":null},"target":"Queue"},{"id":"e38e2b47-cd5f-4a40-9636-2d709114d277","type":"PlayPrompt","branches":[{"condition":"Success","transition":"284b09cf-5cb9-4ee7-bfe1-bd6181cf4e78"}],"parameters":[{"name":"Text","value":"Something wrong.","namespace":null},{"name":"TextToSpeechType","value":"text"}],"metadata":{"position":{"x":3222,"y":246},"useDynamic":false}},{"id":"223af26f-2742-459f-a09b-65e08d4587d7","type":"StartMediaStreaming","branches":[{"condition":"Success","transition":"b37dc81c-107c-4730-8b04-c14ef20edeb8"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[{"name":"ParticipantTypes","value":"Customer"},{"name":"MediaStreamTypes","value":"Audio"}],"metadata":{"position":{"x":2394,"y":19}}},{"id":"b37dc81c-107c-4730-8b04-c14ef20edeb8","type":"SetQueue","branches":[{"condition":"Success","transition":"57f9d28f-f005-4feb-b880-79025fe75e15"},{"condition":"Error","transition":"e38e2b47-cd5f-4a40-9636-2d709114d277"}],"parameters":[{"name":"Queue","value":"queueID","namespace":"External","resourceName":null}],"metadata":{"position":{"x":2640,"y":20},"useDynamic":true,"queue":"queueID"}}],"version":"1","type":"contactFlow","start":"05786880-5093-47af-83fe-571d0874c640","metadata":{"entryPointPosition":{"x":15,"y":29},"snapToGrid":false,"name":"Human-Human/Human-Bot Conversations","description":null,"type":"contactFlow","status":"published","hash":"a00253421c82543abd1f6ba496dc590511c7163e6070482dedf3040b3cb8e552"}}